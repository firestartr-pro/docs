<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="State Repo Apps# This feature enables GitOps-based deployment workflows for application state repositories.
An application state repository (state repo, generally named app-<name>) is a Git repository that holds the Kubernetes deployment configurations for an application, or infrastructure, and secrets related to a specific application or set of services that compose it.
It provides automated CI/CD pipelines for managing Kubernetes workloads, Terraform workspaces, and secrets through GitHub Actions and ArgoCD.
Overview# The state_repo_apps feature installs GitHub Actions workflows that manage an application state repository, enabling three types of deployments:
"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://docs.firestartr.dev/docs/features/state_repo_apps/"><meta property="og:site_name" content="Firestartr Documentation"><meta property="og:title" content="Firestartr Documentation"><meta property="og:description" content="State Repo Apps# This feature enables GitOps-based deployment workflows for application state repositories.
An application state repository (state repo, generally named app-<name>) is a Git repository that holds the Kubernetes deployment configurations for an application, or infrastructure, and secrets related to a specific application or set of services that compose it.
It provides automated CI/CD pipelines for managing Kubernetes workloads, Terraform workspaces, and secrets through GitHub Actions and ArgoCD.
Overview# The state_repo_apps feature installs GitHub Actions workflows that manage an application state repository, enabling three types of deployments:"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><meta itemprop=name content="Firestartr Documentation"><meta itemprop=description content="State Repo Apps# This feature enables GitOps-based deployment workflows for application state repositories.
An application state repository (state repo, generally named app-<name>) is a Git repository that holds the Kubernetes deployment configurations for an application, or infrastructure, and secrets related to a specific application or set of services that compose it.
It provides automated CI/CD pipelines for managing Kubernetes workloads, Terraform workspaces, and secrets through GitHub Actions and ArgoCD.
Overview# The state_repo_apps feature installs GitHub Actions workflows that manage an application state repository, enabling three types of deployments:"><meta itemprop=wordCount content="1316"><title>State Repo Apps | Firestartr Documentation</title><link rel=icon href=/docs/favicon.png><link rel=manifest href=/docs/manifest.json><link rel=canonical href=https://docs.firestartr.dev/docs/features/state_repo_apps/><link rel=stylesheet href=/docs/book.min.cc2c524ed250aac81b23d1f4af87344917b325208841feca0968fe450f570575.css integrity="sha256-zCxSTtJQqsgbI9H0r4c0SRezJSCIQf7KCWj+RQ9XBXU=" crossorigin=anonymous><script defer src=/docs/fuse.min.js></script><script defer src=/docs/en.search.min.27ea268489c4afe5460ac64c12852404231f9abe51a238c074a89899891f1487.js integrity="sha256-J+omhInEr+VGCsZMEoUkBCMfmr5RojjAdKiYmYkfFIc=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://docs.firestartr.dev/docs/features/state_repo_apps/index.xml title="Firestartr Documentation"></head><body dir=ltr class="book-kind-section book-type-features"><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/docs/><span>Firestartr Documentation</span></a></h2><div class="book-search hidden"><input id=book-search-input type=text placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=/docs/Migrating-to-our-new-app-state-repo-structure/>Migrating to Our New App State Repo Structure</a></li><li><input type=checkbox id=section-77ba58481c81cfcc87f14a72108199d0 class=toggle>
<label for=section-77ba58481c81cfcc87f14a72108199d0 class=flex><a href=/docs/providers/>Providers</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><input type=checkbox id=section-b1b6ec47a00c93e67ba6b7835cfc5cbb class=toggle>
<label for=section-b1b6ec47a00c93e67ba6b7835cfc5cbb class=flex><a href=/docs/providers/terraform/>Terraform</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/providers/terraform/workspace-policies/>Workspace Policies</a></li><li><a href=/docs/providers/terraform/workspace-sync/>Workspace Sync</a></li></ul></li></ul></li><li><a href=/docs/state-apps-repository/>State Apps Repository</a></li><li><a href=/docs/state-sys-services-repository/>State Sys Services Repository</a></li><li><a href=/docs/The-dot-firestartr-repository/>The Dot Firestartr Repository</a></li><li><a href=/docs/Validating-our-claims/>Validating Our Claims</a></li><li><input type=checkbox id=section-59625c6804349fe2bfba21980f88c1e3 class=toggle checked>
<label for=section-59625c6804349fe2bfba21980f88c1e3 class=flex><a href=/docs/features/>Features</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><input type=checkbox id=section-175a6acb21b23225ad6bb7d217c9122e class=toggle>
<label for=section-175a6acb21b23225ad6bb7d217c9122e class=flex><a href=/docs/features/build_and_dispatch_docker_images/>Build and Dispatch Docker Images</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/features/build_and_dispatch_docker_images/CHANGELOG/>Changelog</a></li></ul></li><li><input type=checkbox id=section-39ffb35bc31c80c3835fb6d107d8f566 class=toggle>
<label for=section-39ffb35bc31c80c3835fb6d107d8f566 class=flex><a href=/docs/features/catalog_repo/>Catalog Repo</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/features/catalog_repo/CHANGELOG/>Changelog</a></li></ul></li><li><input type=checkbox id=section-6b57e3023d9f976a9384af45ac1defa0 class=toggle>
<label for=section-6b57e3023d9f976a9384af45ac1defa0 class=flex><a href=/docs/features/charts_repo/>Charts Repo</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/features/charts_repo/CHANGELOG/>Changelog</a></li></ul></li><li><input type=checkbox id=section-b6a186066fe5df06a19368fd8c4e2996 class=toggle>
<label for=section-b6a186066fe5df06a19368fd8c4e2996 class=flex><a href=/docs/features/claims_repo/>Claims Repo</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/features/claims_repo/CHANGELOG/>Changelog</a></li></ul></li><li><input type=checkbox id=section-38807a9873b684081175bcfa2c2cf899 class=toggle>
<label for=section-38807a9873b684081175bcfa2c2cf899 class=flex><a href=/docs/features/features_repo/>Features Repo</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/features/features_repo/CHANGELOG/>Changelog</a></li></ul></li><li><input type=checkbox id=section-b095c0174f431275dbfbd179b858882c class=toggle>
<label for=section-b095c0174f431275dbfbd179b858882c class=flex><a href=/docs/features/firestartr_repo/>Firestartr Repo</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/features/firestartr_repo/CHANGELOG/>Changelog</a></li></ul></li><li><input type=checkbox id=section-8c74538169d2bfcc42048e94a7a8b10f class=toggle>
<label for=section-8c74538169d2bfcc42048e94a7a8b10f class=flex><a href=/docs/features/issue_templates/>Issue Templates</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/features/issue_templates/CHANGELOG/>Changelog</a></li></ul></li><li><input type=checkbox id=section-356bba00636a6fa9c561ac1523b4c383 class=toggle>
<label for=section-356bba00636a6fa9c561ac1523b4c383 class=flex><a href=/docs/features/release_please/>Release Please</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/features/release_please/CHANGELOG/>Changelog</a></li></ul></li><li><input type=checkbox id=section-17190a34986f329bfce42d3c100d77a8 class=toggle>
<label for=section-17190a34986f329bfce42d3c100d77a8 class=flex><a href=/docs/features/state_github/>State Github</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/features/state_github/CHANGELOG/>Changelog</a></li></ul></li><li><input type=checkbox id=section-5f9553708125dcb2260eaa1dc68fa4b3 class=toggle>
<label for=section-5f9553708125dcb2260eaa1dc68fa4b3 class=flex><a href=/docs/features/state_infra/>State Infra</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/features/state_infra/CHANGELOG/>Changelog</a></li></ul></li><li><input type=checkbox id=section-5cfdf617da323132dc220c8cdac15345 class=toggle>
<label for=section-5cfdf617da323132dc220c8cdac15345 class=flex><a href=/docs/features/state_repo/>State Repo</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/features/state_repo/CHANGELOG/>Changelog</a></li></ul></li><li><input type=checkbox id=section-ed9c88a7368e2738f3eb675492c08586 class=toggle checked>
<label for=section-ed9c88a7368e2738f3eb675492c08586 class=flex><a href=/docs/features/state_repo_apps/ class=active>State Repo Apps</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/features/state_repo_apps/KUBERNETES_README/>Kubernetes Readme</a></li><li><a href=/docs/features/state_repo_apps/SECRETS_README/>Secrets Readme</a></li><li><a href=/docs/features/state_repo_apps/TFWORKSPACES_README/>Tfworkspaces Readme</a></li><li><a href=/docs/features/state_repo_apps/CHANGELOG/>Changelog</a></li></ul></li><li><input type=checkbox id=section-9b5377154045b7f8613471f4d8281e78 class=toggle>
<label for=section-9b5377154045b7f8613471f4d8281e78 class=flex><a href=/docs/features/state_repo_sys_services/>State Repo Sys Services</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/features/state_repo_sys_services/CHANGELOG/>Changelog</a></li></ul></li><li><input type=checkbox id=section-36ec9bd0ed3955d6fa86995304f3f940 class=toggle>
<label for=section-36ec9bd0ed3955d6fa86995304f3f940 class=flex><a href=/docs/features/tech_docs/>Tech Docs</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/features/tech_docs/CHANGELOG/>Changelog</a></li></ul></li><li><input type=checkbox id=section-85da29a6eded009fe28c389b53dac15e class=toggle>
<label for=section-85da29a6eded009fe28c389b53dac15e class=flex><a href=/docs/features/terraform-infra/>Terraform Infra</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/features/terraform-infra/ACCOUNTS_README/>Accounts Readme</a></li><li><a href=/docs/features/terraform-infra/CHANGELOG/>Changelog</a></li></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class="book-header hidden"><div class="flex align-center justify-between"><label for=menu-control><img src=/docs/icons/menu.svg class=book-icon alt=Menu></label><h3>State Repo Apps</h3><label for=toc-control><img src=/docs/icons/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class=hidden><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#repository-structure>Repository Structure</a><ul><li><a href=#default-branch-main>Default branch (<code>main</code>)</a></li><li><a href=#deployment-branch-deployment>Deployment branch (<code>deployment</code>)</a></li></ul></li><li><a href=#workflows-provided>Workflows Provided</a><ul><li><a href=#validation>Validation</a></li><li><a href=#manual-deployments>Manual Deployments</a></li><li><a href=#automatic-deployments>Automatic Deployments</a></li><li><a href=#delete-deployments>Delete Deployments</a></li><li><a href=#auto-update-workflows>Auto-Update Workflows</a></li></ul></li><li><a href=#documentation>Documentation</a></li><li><a href=#key-features>Key Features</a></li><li><a href=#quick-start>Quick Start</a></li><li><a href=#auto-update-setup>Auto-Update Setup</a><ul><li><a href=#auto-merge-deployment-prs>Auto-Merge Deployment PRs</a></li></ul></li><li><a href=#configuration>Configuration</a><ul><li><a href=#the-firestartr-repository>The .firestartr Repository</a></li></ul></li><li><a href=#rollback>Rollback</a><ul><li><a href=#option-1-using-github-to-revert-a-pr-recommended>Option 1: using GitHub to revert a PR (recommended)</a></li><li><a href=#option-2-manually-edit-the-deployment-branch-not-recommended>Option 2: manually edit the deployment branch (not recommended)</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=state-repo-apps>State Repo Apps<a class=anchor href=#state-repo-apps>#</a></h1><p>This feature enables GitOps-based deployment workflows for application state repositories.</p><p>An application state repository (state repo, generally named <code>app-&lt;name></code>) is a Git repository that holds the Kubernetes deployment configurations for an application, or infrastructure, and secrets related to a specific application or set of services that compose it.</p><p>It provides automated CI/CD pipelines for managing Kubernetes workloads, Terraform workspaces, and secrets through GitHub Actions and ArgoCD.</p><h2 id=overview>Overview<a class=anchor href=#overview>#</a></h2><p>The <code>state_repo_apps</code> feature installs GitHub Actions workflows that manage an application state repository, enabling three types of deployments:</p><ol><li><strong>Kubernetes Workloads</strong> - Deploy containerized applications</li><li><strong>Terraform Workspaces</strong> - Manage infrastructure as code with TFWorkspace claims</li><li><strong>Secrets Management</strong> - Deploy and sync secrets using External Secrets Operator</li></ol><p>All deployments follow a <a href=https://www.gitops.tech/#pull-based-deployments>GitOps pattern</a> where:</p><ul><li>changes are validated through pull requests to the repository default branch</li><li>After merge, the deployment manifests (CRs) are rendered (<em>hydrated</em>) into new pull requests to the <code>deployment</code> branch, one for every affected deployment coordinates.</li><li><strong>ArgoCD</strong> is in charge of monitoring the <code>deployment</code> branch and <strong>pull</strong> the changes from the repository to the destination cluster.
<img src=/docs/images/state_repo_apps-gitops-pull.png alt="gitops schema"></li></ul><p>This feature follows <a href=https://www.gitops.tech/#pull-based-deployments>the <code>pull</code> model</a>, where the changes are hydrated and committed to the <code>deployment</code> branch and then ArgoCD detects those changes and applies them to the cluster, as opposed to <a href=https://www.gitops.tech/#push-based-deployments>the <code>push</code> model</a>, where the changes are pushed to the cluster directly after being rendered.</p><h2 id=repository-structure>Repository Structure<a class=anchor href=#repository-structure>#</a></h2><p>The repository is structured with 2 head branches:</p><ul><li>the default branch (usually <code>master</code> or <code>main</code>), where users upload their deployment configurations.</li><li>the <code>deployment</code> branch, where the CRs to be deployed are hydrated by the <code>generate-deployment-&lt;type>.yaml</code>.</li></ul><p>Each branch is structured as follows:</p><h3 id=default-branch-main>Default branch (<code>main</code>)<a class=anchor href=#default-branch-main>#</a></h3><p>Upon installation, three main directories are created: <code>kubernetes</code>, <code>tfworkspaces</code>, and <code>secrets</code>.</p><p>Each directory holds the dehydrated deployment files for its type and follows the expected folder structure described below:</p><ul><li><code>kubernetes</code> folder structure: <code>&lt;platform></code>/<code>&lt;tenant></code>/<code>&lt;environment></code>. At the same level as the <code>environment</code> folder, an <code>&lt;environment_name>.yaml</code> file is expected, which contains the <a href=/docs/features/state_repo_apps/KUBERNETES_README/#helmfile-configuration>Helmfile release configuration</a> for rendering the Helm charts.</li><li><code>tfworkspaces</code> folder structure: <code>&lt;platform></code>/<code>&lt;tenant></code>/<code>&lt;environment></code>. This folder can contain multiple different, unrelated <code>TFWorkspaceClaim</code>s.</li><li><code>secrets</code>: the expected structure is: <code>&lt;tenant></code>/<code>&lt;environment></code>. This folder can contain multiple <code>SecretsClaim</code>s.</li></ul><blockquote class='book-hint note'><p>Note that the deployment coordinates are defined by the folder structure, and must match the configuration in the <code>.firestartr</code> repository.</p></blockquote><h3 id=deployment-branch-deployment>Deployment branch (<code>deployment</code>)<a class=anchor href=#deployment-branch-deployment>#</a></h3><p>This branch contains the hydrated deployments generated from the default branch config files. These files are Custom Kubernetes Resources (CRs) that will be deployed to the cluster and managed by its corresponding controllers.</p><p>The folder structure is similar to the default branch, as the same <code>kubernetes</code>, <code>tfworkspaces</code>, and <code>secrets</code> folders are created in both branches, with one exception: the <code>tfworkspaces</code> folder has no additional sub-folders, and all rendered <code>TFWorkspaceClaim</code>&rsquo;s are placed directly inside it.</p><p>This branch shouldn&rsquo;t be edited manually unless necessary; however, all changes should be done via PRs to the default branch.</p><h2 id=workflows-provided>Workflows Provided<a class=anchor href=#workflows-provided>#</a></h2><h3 id=validation>Validation<a class=anchor href=#validation>#</a></h3><ul><li><strong>Validate PR</strong> (<code>validate-pr.yml</code>) - Validates all pull request changes before merging</li></ul><h3 id=manual-deployments>Manual Deployments<a class=anchor href=#manual-deployments>#</a></h3><ul><li><strong>Generate Kubernetes Deployment</strong> (<code>generate-deployment-kubernetes.yml</code>): Manually deploy Kubernetes workloads</li><li><strong>Generate TFWorkspace Deployment</strong> (<code>generate-deployment-tfworkspaces.yml</code>): Manually deploy Terraform workspaces</li><li><strong>Generate Secrets Deployment</strong> (<code>generate-deployment-secrets.yml</code>): Manually deploy secrets</li></ul><h3 id=automatic-deployments>Automatic Deployments<a class=anchor href=#automatic-deployments>#</a></h3><ul><li><strong>Auto-generate Deployments</strong> (<code>auto-generate-deployments.yml</code>): Automatically create deployments pull-requests when changes are merged to the main branch, for all deployments affected by the changes.</li></ul><h3 id=delete-deployments>Delete Deployments<a class=anchor href=#delete-deployments>#</a></h3><ul><li><strong>Delete Kubernetes Deployment</strong> (<code>delete-deployment-kubernetes.yml</code>) - Create deletion PR for Kubernetes workloads</li><li><strong>Delete TFWorkspace Deployment</strong> (<code>delete-deployment-tfworkspaces.yml</code>) - Create deletion PR for Terraform workspaces</li><li><strong>Delete Secrets Deployment</strong> (<code>delete-deployment-secrets.yml</code>) - Create deletion PR for deployed secrets</li></ul><h3 id=auto-update-workflows>Auto-Update Workflows<a class=anchor href=#auto-update-workflows>#</a></h3><ul><li><strong>Dispatch Image to Kubernetes</strong> (<code>dispatch-image-kubernetes.yml</code>) - Auto-update Kubernetes workloads when new images are pushed</li><li><strong>Dispatch Image to TFWorkspaces</strong> (<code>dispatch-image-tfworkspaces.yml</code>) - Auto-update TFWorkspace images</li></ul><h2 id=documentation>Documentation<a class=anchor href=#documentation>#</a></h2><p>For detailed information on each deployment type:</p><ul><li><strong><a href=/docs/features/state_repo_apps/KUBERNETES_README/>Kubernetes Deployments</a></strong> - Complete guide for deploying containerized applications</li><li><strong><a href=/docs/features/state_repo_apps/TFWORKSPACES_README/>TFWorkspace Deployments</a></strong> - Guide for managing Terraform infrastructure</li><li><strong><a href=/docs/features/state_repo_apps/SECRETS_README/>Secrets Management</a></strong> - How to deploy and manage secrets</li></ul><h2 id=key-features>Key Features<a class=anchor href=#key-features>#</a></h2><ul><li>GitOps-based deployment using ArgoCD</li><li>Automated image updates with optional auto-merge</li><li>Support for multiple helm chart registries (OCI, HTTPS)</li><li>OIDC authentication for cloud providers (Azure, AWS)</li><li>Pull request validation and preview</li><li>Customizable rendering configurations</li></ul><h2 id=quick-start>Quick Start<a class=anchor href=#quick-start>#</a></h2><ol><li><strong>Configure your workload</strong> - Add configuration files to <code>kubernetes/</code>, <code>tfworkspaces/</code>, or <code>secrets/</code> directories, following the expected structure seen above.</li><li><strong>Create a pull request</strong> to the default branch - The PR will be validated automatically.</li><li><strong>Merge to main</strong> - Once approved, merge your changes. This will trigger the hydration workflows.</li><li><strong>Deploy manually</strong> - Run the appropriate &ldquo;Generate deployment&rdquo; workflow from the Actions tab to create a PR to the <code>deployment</code> branch with the rendered manifests.</li><li><strong>Monitor ArgoCD</strong> - ArgoCD will detect changes in the <code>deployment</code> branch and apply them to the cluster.</li></ol><p>Additionally, within your organization, a <code>.firestartr</code> repository should exist (if it doesn&rsquo;t, contact platform team). This repository contains various configuration files that need to be set up for the deployment process to work correctly. You can read more about it in the <a href=https://docs.firestartr.dev/docs/The-dot-firestartr-repository/>Firestartr documentation</a>.</p><h2 id=auto-update-setup>Auto-Update Setup<a class=anchor href=#auto-update-setup>#</a></h2><p>Every time a new image is pushed to a container registry, an event can be sent to this repository to trigger an automatic update of the deployments using that image.</p><p>This is done through the <code>dispatch-image-&lt;type>.yaml</code> workflows, which listen for repository dispatch events with the appropriate payload.</p><blockquote class='book-hint note'><p>The payload is triggered normally from the service code repository, using the <a href=https://docs.firestartr.dev/docs/features/build_and_dispatch_docker_images/>Firestartr&rsquo;s Build and Dispatch Docker Images</a> feature.</p></blockquote><h3 id=auto-merge-deployment-prs>Auto-Merge Deployment PRs<a class=anchor href=#auto-merge-deployment-prs>#</a></h3><p>This feature can be optionally combined with automatic merging of the generated deployment pull-requests, by adding an empty <strong><code>AUTO_MERGE</code></strong> file to the deployment directory (e.g., <code>kubernetes/my-platform/my-tenant/my-environment/AUTO_MERGE</code>), in the <strong>repository default branch</strong>.</p><h2 id=configuration>Configuration<a class=anchor href=#configuration>#</a></h2><p>The workflows support customization through configuration files in <code>.github/</code>:</p><ul><li><code>hydrate_k8s_config.yaml</code> - Config file for Kubernetes deployments. Allows configuring the helmfile image version and additional commands for the container, before executing the helmfile rendering process.</li><li><code>hydrate_tfworkspaces_config.yaml</code> - Config file for TFWorkspace deployments. Allows configuring the firestartr image version and additional commands for the container, before executing the rendering process.</li></ul><p>See the individual documentation files for complete configuration details and GitHub variables/secrets required.</p><h3 id=the-firestartr-repository>The .firestartr Repository<a class=anchor href=#the-firestartr-repository>#</a></h3><p>Additionally, within your GitHub organization, a <code>.firestartr</code> repository should exist (if it doesn&rsquo;t, contact platform team).</p><p>This repository, managed by the Platform team, contains various configuration guardrails files that need to be set up for the deployment process to work correctly. You can read more about it in <a href=https://docs.firestartr.dev/docs/The-dot-firestartr-repository/>The dot-firestartr repository</a>, but we will provide a small overview of the relevant configurations for this feature here:</p><ul><li>The <strong>platforms</strong> folder: contains the configuration for each <code>platform</code> inside the <code>kubernetes</code> and <code>tfworkspaces</code> deployments. Namely, it contains what <code>tenant</code>s and <code>environment</code>s are valid for each <code>platform</code>, and will be used to validate the subfolders inside the <code>kubernetes</code> and <code>tfworkspaces</code> folders. You can read the full documentation <a href=https://docs.firestartr.dev/docs/The-dot-firestartr-repository/#-platform-configuration-example-and-field-description>here</a>.</li><li>The <strong>validations</strong> folder: contains the configuration files used to validate the claims inside the <code>tfworkspaces</code> folder. Read more <a href=https://docs.firestartr.dev/docs/The-dot-firestartr-repository/#-app-validation-configuration-example-and-field-description>here</a>.</li><li>The <strong>docker_registries</strong> folder: will be checked to create the Helm repository information for the Kubernetes deployments, if not already present in the <code>environment.yaml</code> file. Read more <a href=https://docs.firestartr.dev/docs/The-dot-firestartr-repository/#-registry-configuration-example-and-field-description>here</a>.</li></ul><h2 id=rollback>Rollback<a class=anchor href=#rollback>#</a></h2><p>This feature doesn&rsquo;t offer a specific workflow or action to perform rollbacks. Instead, the expected way to rollback a deployment is any of the following:</p><blockquote class='book-hint caution'><p>Note that for all options the changes only affect the state repo. Further dispatches done from the code repo after a rollback will create pull-requests where the deployments will be updated as normal.</p></blockquote><h3 id=option-1-using-github-to-revert-a-pr-recommended>Option 1: using GitHub to revert a PR (recommended)<a class=anchor href=#option-1-using-github-to-revert-a-pr-recommended>#</a></h3><p>Locate the deployment PR you need to rollback using GitHub&rsquo;s interface, and revert it by pressing the <code>Revert PR</code> button. This will create a new PR reverting the deployment PR&rsquo;s changes. Review this new PR and merge it as usual. This is the quickest and easiest way to rollback changes whenever available.</p><p><img src=/docs/images/state_repo_apps-revert.png alt="revert pr"></p><h3 id=option-2-manually-edit-the-deployment-branch-not-recommended>Option 2: manually edit the deployment branch (not recommended)<a class=anchor href=#option-2-manually-edit-the-deployment-branch-not-recommended>#</a></h3><ul><li>Pull the changes from the state repo (<code>git fetch origin</code>),</li><li>checkout to the <code>deployment</code> branch and manually edit the deployment files.</li><li>Create a PR with your changes and merge it.</li></ul><p>This method allows for more flexibility and partial rollbacks, but is more error-prone and not recommended unless you really know what you are doing.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div></div><div></div></div><div class="flex flex-wrap justify-between"><span><a href=/docs/features/state_repo/CHANGELOG/ class="flex align-center"><img src=/docs/icons/backward.svg class=book-icon alt=Backward>
<span>Changelog</span>
</a></span><span><a href=/docs/features/state_repo_apps/KUBERNETES_README/ class="flex align-center"><span>Kubernetes Readme</span>
<img src=/docs/icons/forward.svg class=book-icon alt=Forward></a></span></div><script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#repository-structure>Repository Structure</a><ul><li><a href=#default-branch-main>Default branch (<code>main</code>)</a></li><li><a href=#deployment-branch-deployment>Deployment branch (<code>deployment</code>)</a></li></ul></li><li><a href=#workflows-provided>Workflows Provided</a><ul><li><a href=#validation>Validation</a></li><li><a href=#manual-deployments>Manual Deployments</a></li><li><a href=#automatic-deployments>Automatic Deployments</a></li><li><a href=#delete-deployments>Delete Deployments</a></li><li><a href=#auto-update-workflows>Auto-Update Workflows</a></li></ul></li><li><a href=#documentation>Documentation</a></li><li><a href=#key-features>Key Features</a></li><li><a href=#quick-start>Quick Start</a></li><li><a href=#auto-update-setup>Auto-Update Setup</a><ul><li><a href=#auto-merge-deployment-prs>Auto-Merge Deployment PRs</a></li></ul></li><li><a href=#configuration>Configuration</a><ul><li><a href=#the-firestartr-repository>The .firestartr Repository</a></li></ul></li><li><a href=#rollback>Rollback</a><ul><li><a href=#option-1-using-github-to-revert-a-pr-recommended>Option 1: using GitHub to revert a PR (recommended)</a></li><li><a href=#option-2-manually-edit-the-deployment-branch-not-recommended>Option 2: manually edit the deployment branch (not recommended)</a></li></ul></li></ul></nav></div></aside></main></body></html>